<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>rbmi: Implementation of retrieved-dropout models using rbmi • rbmi</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="rbmi: Implementation of retrieved-dropout models using rbmi">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rbmi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.6.0001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/advanced.html">rbmi: Advanced Functionality</a></li>
    <li><a class="dropdown-item" href="../articles/CondMean_Inference.html">rbmi: Inference with Conditional Mean Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/FAQ.html">rbmi: Frequently Asked Questions</a></li>
    <li><a class="dropdown-item" href="../articles/quickstart.html">rbmi: Quickstart</a></li>
    <li><a class="dropdown-item" href="../articles/retrieved_dropout.html">rbmi: Implementation of retrieved-dropout models using rbmi</a></li>
    <li><a class="dropdown-item" href="../articles/stat_specs.html">rbmi: Statistical Specifications</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<!-- start dropdown for versions --> <li class="nav-item dropdown">
        <a href="#" class="nav-link dropdown-toggle"
          data-bs-toggle="dropdown" role="button"
          aria-expanded="false" aria-haspopup="true"
          id="dropdown-versions">Versions</a> <div class="dropdown-menu" aria-labelledby="dropdown-versions"> <a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rbmi/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rbmi/latest-tag">latest-tag</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rbmi/v1.2.6">v1.2.6</a> </div></li>
<!-- end dropdown for versions -->
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/insightsengineering/rbmi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>rbmi: Implementation of retrieved-dropout models using rbmi</h1>
                        <h4 data-toc-skip class="author">Alessandro Noci, Marcel Wolbers</h4>
            
            <h4 data-toc-skip class="date">2024-07-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/rbmi/blob/main/vignettes/retrieved_dropout.Rmd" class="external-link"><code>vignettes/retrieved_dropout.Rmd</code></a></small>
      <div class="d-none name"><code>retrieved_dropout.Rmd</code></div>
    </div>

    
    
<p>This vignette describes how retrieved dropout models which include time-varying intercurrent event (ICE) indicators can be
implemented in the <code>rbmi</code> package.</p>
<div class="section level2" number="1">
<h2 id="retrieved-dropout-models-in-a-nutshell">
<span class="header-section-number">1</span> Retrieved dropout models in a nutshell<a class="anchor" aria-label="anchor" href="#retrieved-dropout-models-in-a-nutshell"></a>
</h2>
<p>Retrieved dropout models have been proposed for the analysis of estimands using the treatment policy strategy for addressing an ICE.
In these models, missing outcomes are multiply imputed conditional upon whether they occur pre- or post-ICE. Retrieved dropout models
typically rely on an extended missing-at-random (MAR) assumption, i.e., they assume that missing outcome data is similar to observed
data from subjects in the same treatment group with the same observed outcome history, and the same ICE status. For a more
comprehensive description and evaluation of retrieved dropout models, we refer to <span class="citation">Guizzaro et al. (<a href="#ref-Guizzaro2021">2021</a>)</span>, <span class="citation">Polverejan and Dragalin (<a href="#ref-PolverejanDragalin2020">2020</a>)</span>, <span class="citation">Noci et al. (<a href="#ref-Noci2021">2023</a>)</span>,
<span class="citation">Drury et al. (<a href="#ref-Drury2024">2024</a>)</span>, and <span class="citation">Bell et al. (<a href="#ref-Bell2024">2024</a>)</span>. Broadly, these publications find that retrieved dropout models reduce bias compared to alternative
analysis approaches based on imputation under a basic MAR assumption or a reference-based missing data assumption. However, several
issues of retrieved dropout models have also been highlighted. Retrieved dropout models require that enough post-ICE data is
collected to inform the imputation model. Even with relatively small amounts of missingness, complex retrieved dropout models may
face identifiability issues. Another drawback to these models in general is the loss of power relative to reference-based imputation methods, which
becomes meaningful for post-ICE observation percentages below 50% and increases at an accelerating rate as this percentage decreases <span class="citation">(<a href="#ref-Bell2024">Bell et al. 2024</a>)</span>.</p>
</div>
<div class="section level2" number="2">
<h2 id="sec:dataSimul">
<span class="header-section-number">2</span> Data simulation using function <code>simulate_data()</code><a class="anchor" aria-label="anchor" href="#sec:dataSimul"></a>
</h2>
<p>For the purposes of this vignette we will first create a simulated dataset with the <code>rbmi</code> function <code><a href="../reference/simulate_data.html">simulate_data()</a></code>.
The <code><a href="../reference/simulate_data.html">simulate_data()</a></code> function generates data from a randomized clinical trial with longitudinal continuous outcomes and up to two
different types of ICEs.</p>
<p>Specifically, we simulate a 1:1 randomized trial of an active drug (intervention) versus placebo (control) with 100 subjects per
group and 4 post-baseline assessments (3-monthly visits until 12 months):</p>
<ul>
<li>The mean outcome trajectory in the placebo group increases linearly from 50 at baseline (visit 0) to 60 at visit 4, i.e. the slope is 10 points/year (or 2.5 points every 3 months).</li>
<li>The mean outcome trajectory in the intervention group is identical to the placebo group up to month 6. From month 6 onward, the slope decreases by 50% to 5 points/year (i.e. 1.25 points every 3 months).</li>
<li>The covariance structure of the baseline and follow-up values in both groups is implied by a random intercept and slope model
with a standard deviation of 5 for both the intercept and the slope, and a correlation of 0.25. In addition, an independent
residual error with standard deviation 2.5 is added to each assessment.<br>
</li>
<li>The probability of the intercurrent event study drug discontinuation after each visit is calculated according to a logistic model which depends on the observed outcome at that visit.
Specifically, a visit-wise discontinuation probability of 3% and 4% in the control and intervention group, respectively, is specified in case the observed outcome is equal to 50 (the mean value at baseline).
The odds of a discontinuation is simulated to increase by +10% for each +1 point increase of the observed outcome.</li>
<li>Study drug discontinuation is simulated to have no effect on the mean trajectory in the placebo group.
In the intervention group, subjects who discontinue follow the slope of the mean trajectory from the placebo group
from that time point onward. This is compatible with a copy increments in reference (CIR) assumption.</li>
<li>Study dropout at the study drug discontinuation visit occurs with a probability of 50% leading to missing outcome
data from that time point onward.</li>
</ul>
<p>The function <code><a href="../reference/simulate_data.html">simulate_data()</a></code> requires 3 arguments (see the function documentation <code><a href="../reference/simulate_data.html">help(simulate_data)</a></code> for more details):</p>
<ul>
<li>
<code>pars_c</code>: The simulation parameters of the control group.</li>
<li>
<code>pars_t</code>: The simulation parameters of the intervention group.</li>
<li>
<code>post_ice1_traj</code>: Specifies how observed outcomes after ICE1 are simulated.</li>
</ul>
<p>Below, we report how data according to the specifications above can be simulated with function <code><a href="../reference/simulate_data.html">simulate_data()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://insightsengineering.github.io/rbmi/" class="external-link">rbmi</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1392</span><span class="op">)</span></span>
<span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mean trajectory control</span></span>
<span><span class="va">muC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50.0</span>, <span class="fl">52.5</span>, <span class="fl">55.0</span>, <span class="fl">57.5</span>, <span class="fl">60.0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mean trajectory intervention</span></span>
<span><span class="va">muT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50.0</span>, <span class="fl">52.5</span>, <span class="fl">55.0</span>, <span class="fl">56.25</span>, <span class="fl">57.50</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create Sigma</span></span>
<span><span class="va">sd_error</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span><span class="va">covRE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25.0</span>, <span class="fl">6.25</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6.25</span>, <span class="fl">25.0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">time</span> <span class="op">/</span> <span class="fl">12</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span></span>
<span>    <span class="va">covRE</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">time</span> <span class="op">/</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">sd_error</span><span class="op">^</span><span class="fl">2</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set simulation parameters of the control group</span></span>
<span><span class="va">parsC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_simul_pars.html">set_simul_pars</a></span><span class="op">(</span></span>
<span>    mu <span class="op">=</span> <span class="va">muC</span>,</span>
<span>    sigma <span class="op">=</span> <span class="va">Sigma</span>,</span>
<span>    n <span class="op">=</span> <span class="fl">100</span>, <span class="co"># sample size</span></span>
<span>    prob_ice1 <span class="op">=</span> <span class="fl">0.03</span>, <span class="co"># prob of discontinuation for outcome equal to 50</span></span>
<span>    or_outcome_ice1 <span class="op">=</span> <span class="fl">1.10</span>,  <span class="co"># +1 point increase =&gt; +10% odds of discontinuation</span></span>
<span>    prob_post_ice1_dropout <span class="op">=</span> <span class="fl">0.5</span> <span class="co"># dropout rate following discontinuation</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set simulation parameters of the intervention group</span></span>
<span><span class="va">parsT</span> <span class="op">&lt;-</span> <span class="va">parsC</span></span>
<span><span class="va">parsT</span><span class="op">$</span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">muT</span></span>
<span><span class="va">parsT</span><span class="op">$</span><span class="va">prob_ice1</span> <span class="op">&lt;-</span> <span class="fl">0.04</span></span>
<span></span>
<span><span class="co"># Simulate data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_data.html">simulate_data</a></span><span class="op">(</span></span>
<span>    pars_c <span class="op">=</span> <span class="va">parsC</span>,</span>
<span>    pars_t <span class="op">=</span> <span class="va">parsT</span>,</span>
<span>    post_ice1_traj <span class="op">=</span> <span class="st">"CIR"</span> <span class="co"># Assumption about post-ice trajectory</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">outcome_noICE</span>, <span class="va">ind_ice2</span><span class="op">)</span><span class="op">)</span> <span class="co"># remove unncessary columns</span></span>
<span>  </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     id visit   group outcome_bl ind_ice1 dropout_ice1  outcome</span></span>
<span><span class="co">## 1 id_1     0 Control   53.35397        0            0 53.35397</span></span>
<span><span class="co">## 2 id_1     1 Control   53.35397        0            0 55.15100</span></span>
<span><span class="co">## 3 id_1     2 Control   53.35397        0            0 59.81038</span></span>
<span><span class="co">## 4 id_1     3 Control   53.35397        0            0 61.59709</span></span>
<span><span class="co">## 5 id_1     4 Control   53.35397        0            0 67.08044</span></span>
<span><span class="co">## 6 id_2     0 Control   53.31025        0            0 53.31025</span></span></code></pre>
<p>The frequency of the ICE and proportion of data collected after the ICE impacts the variance of the treatment effect for
retrieved dropout models. For example, a large proportion of ICE combined with a small proportion of data collected after the
ICE might result in substantial variance inflation, especially for more complex retrieved dropout models.</p>
<p>The proportion of subjects with an ICE and the proportion of subjects who withdrew from the simulated study is summarized below:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute endpoint of interest: change from baseline</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">visit</span> <span class="op">!=</span> <span class="st">"0"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    change <span class="op">=</span> <span class="va">outcome</span> <span class="op">-</span> <span class="va">outcome_bl</span>,</span>
<span>    visit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">visit</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">visit</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>      </span>
<span></span>
<span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">visit</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    freq_disc_ctrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ind_ice1</span><span class="op">[</span><span class="va">group</span> <span class="op">==</span> <span class="st">"Control"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    freq_dropout_ctrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dropout_ice1</span><span class="op">[</span><span class="va">group</span> <span class="op">==</span> <span class="st">"Control"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    freq_disc_interv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ind_ice1</span><span class="op">[</span><span class="va">group</span> <span class="op">==</span> <span class="st">"Intervention"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    freq_dropout_interv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dropout_ice1</span><span class="op">[</span><span class="va">group</span> <span class="op">==</span> <span class="st">"Intervention"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">##   visit freq_disc_ctrl freq_dropout_ctrl freq_disc_interv freq_dropout_interv</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 1               0.03              0.01             0.06                0.03</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2               0.1               0.03             0.1                 0.04</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 3               0.19              0.09             0.17                0.06</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 4               0.23              0.12             0.24                0.1</span></span></code></pre>
<p>For this study 23% of the study participants discontinued from study treatment in the control arm and 24% in the intervention
arm. Approximately half of the participants who discontinued from treatment dropped-out from the study at the discontinuation
visit leading to missing outcomes at subsequent visits.</p>
</div>
<div class="section level2" number="3">
<h2 id="estimators-based-on-retrieved-dropout-models">
<span class="header-section-number">3</span> Estimators based on retrieved dropout models<a class="anchor" aria-label="anchor" href="#estimators-based-on-retrieved-dropout-models"></a>
</h2>
<p>We consider retrieved dropout methods which model pre- and post-ICE outcomes jointly by including time-varying ICE indicators in
the imputation model, i.e. we allow the occurrence of the ICE to impact the mean structure but not the covariance matrix.
Imputation of missing outcomes is then performed under a MAR assumption including all observed data. For the analysis of the
completed data, we use a standard ANCOVA model of the outcome at each follow-up visit, respectively, with treatment assignment
as the main covariate and adjustment for the baseline outcome.</p>
<p>Specifically, we consider the following imputation models:</p>
<ul>
<li>
<strong>Imputation under a basic MAR assumption (basic MAR)</strong>: This model ignores whether an outcome is observed pre- or post-ICE,
i.e. it is not a retrieved dropout model. Rather, it is asymptotically equivalent to a standard MMRM model and analogous to the
“MI1” model in <span class="citation">Bell et al. (<a href="#ref-Bell2024">2024</a>)</span>. The only difference to the “MI1” model is that <code>rbmi</code> is not based on sequential imputation but
rather, all missing outcomes are imputed simultaneously based on a MMRM-type imputation model. We include baseline outcome by
visit and treatment group by visit interaction terms in the imputation model which is of the form:
<code>change ~ outcome_bl*visit + group*visit</code>.</li>
<li>
<strong>Retrieved dropout model 1 (RD1)</strong>: This model uses the following imputation model:
<code>change ~ outcome_bl*visit + group*visit + time_since_ice1*group</code>, where <code>time_since_ice1</code> is set to 0 up to
the treatment discontinuation and to the time from treatment
discontinuation (in months) at subsequent visits. This implies a change in the slope of the outcome trajectories after the ICE, which
is modeled separately for each treatment arm. This model is similar to the “TV2-MAR” estimator in <span class="citation">Noci et al. (<a href="#ref-Noci2021">2023</a>)</span>. Compared to the basic
MAR model, this model requires estimation of 2 additional parameters.</li>
<li>
<strong>Retrieved dropout model 2 (RD2)</strong>: This model uses the following imputation model: <code>change ~ outcome_bl*visit + group*visit +  ind_ice1*group*visit</code>. This assumes a constant shift in outcomes after the ICE, which is modeled separately for each treatment arm
and each visit. This model is analogous to the “MI2” model in <span class="citation">Bell et al. (<a href="#ref-Bell2024">2024</a>)</span>. Compared to the basic MAR model, this model requires
estimation of 2 times “number of visits” additional parameters. It makes different though rather weaker assumptions than the RD1
model but might also be harder to fit if post-ICE data collection is sparse at some visits.</li>
</ul>
</div>
<div class="section level2" number="4">
<h2 id="implementation-of-the-defined-retrieved-dropout-models-in-rbmi">
<span class="header-section-number">4</span> Implementation of the defined retrieved dropout models in <code>rbmi</code><a class="anchor" aria-label="anchor" href="#implementation-of-the-defined-retrieved-dropout-models-in-rbmi"></a>
</h2>
<p><code>rbmi</code> supports the inclusion of time-varying covariates in the imputation model. The only requirement is that the time-varying
covariate is non-missing at all visits including those where the outcome might be missing.
Imputation is performed under a (extended) MAR assumption. Therefore, all imputation approaches implemented in <code>rbmi</code> are valid and
should yield comparable estimators and standard errors.
For this vignette, we used the conditional mean imputation approach combined with the jackknife.</p>
<div class="section level3" number="4.1">
<h3 id="basic-mar-model">
<span class="header-section-number">4.1</span> Basic MAR model<a class="anchor" aria-label="anchor" href="#basic-mar-model"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define key variables for the imputation and analysis models</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_vars.html">set_vars</a></span><span class="op">(</span></span>
<span>  subjid <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  visit <span class="op">=</span> <span class="st">"visit"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"change"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"outcome_bl*visit"</span>, <span class="st">"group*visit"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vars_an</span> <span class="op">&lt;-</span> <span class="va">vars</span></span>
<span><span class="va">vars_an</span><span class="op">$</span><span class="va">covariates</span> <span class="op">&lt;-</span> <span class="st">"outcome_bl"</span></span>
<span></span>
<span><span class="co"># Define imputation method</span></span>
<span><span class="va">method</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/method.html">method_condmean</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"jackknife"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">draw_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draws.html">draws</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  data_ice <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vars <span class="op">=</span> <span class="va">vars</span>,</span>
<span>  method <span class="op">=</span> <span class="va">method</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">impute_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/impute.html">impute</a></span><span class="op">(</span></span>
<span>  <span class="va">draw_obj</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ana_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyse.html">analyse</a></span><span class="op">(</span></span>
<span>  <span class="va">impute_obj</span>,</span>
<span>  vars <span class="op">=</span> <span class="va">vars_an</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pool_obj_basicMAR</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pool.html">pool</a></span><span class="op">(</span><span class="va">ana_obj</span><span class="op">)</span></span>
<span><span class="va">pool_obj_basicMAR</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Pool Object</span></span>
<span><span class="co">## -----------</span></span>
<span><span class="co">## Number of Results Combined: 1 + 200</span></span>
<span><span class="co">## Method: jackknife</span></span>
<span><span class="co">## Confidence Level: 0.95</span></span>
<span><span class="co">## Alternative: two.sided</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   ==================================================</span></span>
<span><span class="co">##    parameter   est     se     lci     uci     pval  </span></span>
<span><span class="co">##   --------------------------------------------------</span></span>
<span><span class="co">##      trt_1    -0.991  0.557  -2.083  0.101   0.075  </span></span>
<span><span class="co">##    lsm_ref_1  3.117   0.401  2.331   3.902   &lt;0.001 </span></span>
<span><span class="co">##    lsm_alt_1  2.126   0.391   1.36   2.892   &lt;0.001 </span></span>
<span><span class="co">##      trt_2    -0.937  0.611  -2.134   0.26   0.125  </span></span>
<span><span class="co">##    lsm_ref_2  5.814   0.447  4.938    6.69   &lt;0.001 </span></span>
<span><span class="co">##    lsm_alt_2  4.877   0.414  4.066   5.688   &lt;0.001 </span></span>
<span><span class="co">##      trt_3    -1.491  0.743  -2.948  -0.034  0.045  </span></span>
<span><span class="co">##    lsm_ref_3  7.725   0.526  6.694   8.757   &lt;0.001 </span></span>
<span><span class="co">##    lsm_alt_3  6.234   0.522  5.211   7.258   &lt;0.001 </span></span>
<span><span class="co">##      trt_4    -2.872  0.945  -4.723  -1.02   0.002  </span></span>
<span><span class="co">##    lsm_ref_4  10.787  0.661  9.491   12.083  &lt;0.001 </span></span>
<span><span class="co">##    lsm_alt_4  7.915   0.67   6.603   9.228   &lt;0.001 </span></span>
<span><span class="co">##   --------------------------------------------------</span></span></code></pre>
</div>
<div class="section level3" number="4.2">
<h3 id="retrieved-dropout-model-1-rd1">
<span class="header-section-number">4.2</span> Retrieved dropout model 1 (RD1)<a class="anchor" aria-label="anchor" href="#retrieved-dropout-model-1-rd1"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># derive variable "time_since_ice1" (time since ICE in months)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>time_since_ice1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">ind_ice1</span><span class="op">)</span><span class="op">*</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vars</span><span class="op">$</span><span class="va">covariates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"outcome_bl*visit"</span>, <span class="st">"group*visit"</span>, <span class="st">"time_since_ice1*group"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">draw_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draws.html">draws</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  data_ice <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vars <span class="op">=</span> <span class="va">vars</span>,</span>
<span>  method <span class="op">=</span> <span class="va">method</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">impute_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/impute.html">impute</a></span><span class="op">(</span></span>
<span>  <span class="va">draw_obj</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ana_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyse.html">analyse</a></span><span class="op">(</span></span>
<span>  <span class="va">impute_obj</span>,</span>
<span>  vars <span class="op">=</span> <span class="va">vars_an</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pool_obj_RD1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pool.html">pool</a></span><span class="op">(</span><span class="va">ana_obj</span><span class="op">)</span></span>
<span><span class="va">pool_obj_RD1</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Pool Object</span></span>
<span><span class="co">## -----------</span></span>
<span><span class="co">## Number of Results Combined: 1 + 200</span></span>
<span><span class="co">## Method: jackknife</span></span>
<span><span class="co">## Confidence Level: 0.95</span></span>
<span><span class="co">## Alternative: two.sided</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   ==================================================</span></span>
<span><span class="co">##    parameter   est     se     lci     uci     pval  </span></span>
<span><span class="co">##   --------------------------------------------------</span></span>
<span><span class="co">##      trt_1    -0.931  0.558  -2.025  0.163   0.095  </span></span>
<span><span class="co">##    lsm_ref_1  3.119    0.4   2.334   3.903   &lt;0.001 </span></span>
<span><span class="co">##    lsm_alt_1  2.188   0.393  1.419   2.957   &lt;0.001 </span></span>
<span><span class="co">##      trt_2    -0.805  0.616  -2.013  0.403   0.192  </span></span>
<span><span class="co">##    lsm_ref_2  5.822   0.445  4.949   6.695   &lt;0.001 </span></span>
<span><span class="co">##    lsm_alt_2  5.017   0.424  4.186   5.849   &lt;0.001 </span></span>
<span><span class="co">##      trt_3    -1.263  0.758  -2.748  0.222   0.096  </span></span>
<span><span class="co">##    lsm_ref_3  7.749   0.52   6.729   8.768   &lt;0.001 </span></span>
<span><span class="co">##    lsm_alt_3  6.486   0.549   5.41   7.562   &lt;0.001 </span></span>
<span><span class="co">##      trt_4    -2.506  0.969  -4.406  -0.606   0.01  </span></span>
<span><span class="co">##    lsm_ref_4  10.837  0.653  9.558   12.116  &lt;0.001 </span></span>
<span><span class="co">##    lsm_alt_4  8.331   0.718  6.924   9.737   &lt;0.001 </span></span>
<span><span class="co">##   --------------------------------------------------</span></span></code></pre>
</div>
<div class="section level3" number="4.3">
<h3 id="retrieved-dropout-model-2-rd2">
<span class="header-section-number">4.3</span> Retrieved dropout model 2 (RD2)<a class="anchor" aria-label="anchor" href="#retrieved-dropout-model-2-rd2"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vars</span><span class="op">$</span><span class="va">covariates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"outcome_bl*visit"</span>, <span class="st">"group*visit"</span>, <span class="st">"ind_ice1*group*visit"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">draw_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draws.html">draws</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  data_ice <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vars <span class="op">=</span> <span class="va">vars</span>,</span>
<span>  method <span class="op">=</span> <span class="va">method</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">impute_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/impute.html">impute</a></span><span class="op">(</span></span>
<span>  <span class="va">draw_obj</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ana_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyse.html">analyse</a></span><span class="op">(</span></span>
<span>  <span class="va">impute_obj</span>,</span>
<span>  vars <span class="op">=</span> <span class="va">vars_an</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pool_obj_RD2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pool.html">pool</a></span><span class="op">(</span><span class="va">ana_obj</span><span class="op">)</span></span>
<span><span class="va">pool_obj_RD2</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Pool Object</span></span>
<span><span class="co">## -----------</span></span>
<span><span class="co">## Number of Results Combined: 1 + 200</span></span>
<span><span class="co">## Method: jackknife</span></span>
<span><span class="co">## Confidence Level: 0.95</span></span>
<span><span class="co">## Alternative: two.sided</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   ==================================================</span></span>
<span><span class="co">##    parameter   est     se     lci     uci     pval  </span></span>
<span><span class="co">##   --------------------------------------------------</span></span>
<span><span class="co">##      trt_1    -0.927  0.558  -2.021  0.167   0.097  </span></span>
<span><span class="co">##    lsm_ref_1  3.125    0.4   2.341   3.908   &lt;0.001 </span></span>
<span><span class="co">##    lsm_alt_1  2.198   0.395  1.424   2.972   &lt;0.001 </span></span>
<span><span class="co">##      trt_2    -0.889  0.612  -2.089  0.311   0.146  </span></span>
<span><span class="co">##    lsm_ref_2  5.837   0.443   4.97   6.705   &lt;0.001 </span></span>
<span><span class="co">##    lsm_alt_2  4.948   0.421  4.124   5.772   &lt;0.001 </span></span>
<span><span class="co">##      trt_3    -1.305  0.757  -2.788  0.178   0.085  </span></span>
<span><span class="co">##    lsm_ref_3  7.648   0.54    6.59   8.707   &lt;0.001 </span></span>
<span><span class="co">##    lsm_alt_3  6.343   0.528  5.308   7.378   &lt;0.001 </span></span>
<span><span class="co">##      trt_4    -2.617  0.975  -4.528  -0.706  0.007  </span></span>
<span><span class="co">##    lsm_ref_4  10.883  0.665   9.58   12.186  &lt;0.001 </span></span>
<span><span class="co">##    lsm_alt_4  8.267   0.715  6.866   9.667   &lt;0.001 </span></span>
<span><span class="co">##   --------------------------------------------------</span></span></code></pre>
</div>
<div class="section level3" number="4.4">
<h3 id="brief-summary-of-results">
<span class="header-section-number">4.4</span> Brief summary of results<a class="anchor" aria-label="anchor" href="#brief-summary-of-results"></a>
</h3>
<p>The point estimators of the treatment effect at the last visit were
-2.872,
-2.506, and
-2.617 for the basic MAR, RD1, and RD2 estimators, respectively, i.e. slightly
smaller for the retrieved dropout models compared to the basic MAR model.
The corresponding standard errors of the 3 estimators were
0.945,
0.969, and
0.975, i.e. slightly larger for the retrieved dropout models compared to the
basic MAR model.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Bell2024" class="csl-entry">
Bell, James, Thomas Drury, Tobias Mütze, Christian Bressen Pipper, Lorenzo Guizzaro, Marian Mitroiu, Khadija Rerhou Rantell, Marcel Wolbers, and David Wright. 2024. <span>“Estimation Methods for Estimands Using the Treatment Policy Strategy; a Simulation Study Based on the PIONEER 1 Trial.”</span> <em>arXiv Preprint</em>. <a href="https://arxiv.org/abs/2402.12850" class="external-link">https://arxiv.org/abs/2402.12850</a>.
</div>
<div id="ref-Drury2024" class="csl-entry">
Drury, Thomas, Juan J Abellan, Nicky Best, and Ian R White. 2024. <span>“Estimation of Treatment Policy Estimands for Continuous Outcomes Using Off-Treatment Sequential Multiple Imputation.”</span> <em>Pharmaceutical Statistics</em>.
</div>
<div id="ref-Guizzaro2021" class="csl-entry">
Guizzaro, Lorenzo, Frank Pétavy, Robin Ristl, and Ciro Gallo. 2021. <span>“The Use of a Variable Representing Compliance Improves Accuracy of Estimation of the Effect of Treatment Allocation Regardless of Discontinuation in Trials with Incomplete Follow-up.”</span> <em>Statistics in Biopharmaceutical Research</em> 13 (1): 119–27.
</div>
<div id="ref-Noci2021" class="csl-entry">
Noci, Alessandro, Marcel Wolbers, Markus Abt, Corine Baayen, Hans Ulrich Burger, Man Jin, and Weining Zhao Robieson. 2023. <span>“A Comparison of Estimand and Estimation Strategies for Clinical Trials in Early Parkinson’s Disease.”</span> <em>Statistics in Biopharmaceutical Research</em> 15 (3): 491–501.
</div>
<div id="ref-PolverejanDragalin2020" class="csl-entry">
Polverejan, Elena, and Vladimir Dragalin. 2020. <span>“Aligning Treatment Policy Estimands and Estimators—a Simulation Study in Alzheimer’s Disease.”</span> <em>Statistics in Biopharmaceutical Research</em> 12 (2): 142–54.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Craig Gower-Page, Alessandro Noci, F. Hoffmann-La Roche AG.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>

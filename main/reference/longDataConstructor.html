<!DOCTYPE html>
<!-- Generated by pkgdown + https://github.com/insightsengineering/r-pkgdown-multiversion -->
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>R6 Class for Storing / Accessing &amp; Sampling Longitudinal Data — longDataConstructor • rbmi</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="R6 Class for Storing / Accessing &amp; Sampling Longitudinal Data — longDataConstructor">
<meta name="description" content="A longdata object allows for efficient storage and recall of longitudinal datasets for use in
bootstrap sampling. The object works by de-constructing the data into lists based upon subject id
thus enabling efficient lookup.">
<meta property="og:description" content="A longdata object allows for efficient storage and recall of longitudinal datasets for use in
bootstrap sampling. The object works by de-constructing the data into lists based upon subject id
thus enabling efficient lookup.">
<meta property="og:image" content="/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rbmi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/advanced.html">rbmi: Advanced Functionality</a></li>
    <li><a class="dropdown-item" href="../articles/CondMean_Inference.html">rbmi: Inference with Conditional Mean Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/FAQ.html">rbmi: Frequently Asked Questions</a></li>
    <li><a class="dropdown-item" href="../articles/quickstart.html">rbmi: Quickstart</a></li>
    <li><a class="dropdown-item" href="../articles/retrieved_dropout.html">rbmi: Implementation of retrieved-dropout models using rbmi</a></li>
    <li><a class="dropdown-item" href="../articles/stat_specs.html">rbmi: Statistical Specifications</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      <div><li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-versions">Versions</a>
    <div class="dropdown-menu" aria-labelledby="dropdown-versions">
    <a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rbmi/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rbmi/latest-tag">latest-tag</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rbmi/v1.4.0">v1.4.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rbmi/v1.3.1">v1.3.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rbmi/v1.3.0">v1.3.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/rbmi/v1.2.6">v1.2.6</a>
</div>
</li></div>
</ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/insightsengineering/rbmi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>R6 Class for Storing / Accessing &amp; Sampling Longitudinal Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/rbmi/blob/main/R/longData.R" class="external-link"><code>R/longData.R</code></a></small>
      <div class="d-none name"><code>longDataConstructor.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A <code>longdata</code> object allows for efficient storage and recall of longitudinal datasets for use in
bootstrap sampling. The object works by de-constructing the data into lists based upon subject id
thus enabling efficient lookup.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a>
</h2>
    <p>The object also handles multiple other operations specific to <code>rbmi</code> such as defining whether an
outcome value is MAR / Missing or not as well as tracking which imputation strategy is assigned
to each subject.</p>
<p>It is recognised that this objects functionality is fairly overloaded and is hoped that this can
be split out into more area specific objects / functions in the future. Further additions of functionality
to this object should be avoided if possible.</p>
    </div>
    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a>
</h2>
    <p></p>
<div class="r6-fields">
<dl>
<dt><code>data</code></dt>
<dd><p>The original dataset passed to the constructor (sorted by id and visit)</p></dd>


<dt><code>vars</code></dt>
<dd><p>The vars object (list of key variables) passed to the constructor</p></dd>


<dt><code>visits</code></dt>
<dd><p>A character vector containing the distinct visit levels</p></dd>


<dt><code>ids</code></dt>
<dd><p>A character vector containing the unique ids of each subject in <code>self$data</code></p></dd>


<dt><code>formula</code></dt>
<dd><p>A formula expressing how the design matrix for the data should be constructed</p></dd>


<dt><code>strata</code></dt>
<dd><p>A numeric vector indicating which strata each corresponding value of
<code>self$ids</code> belongs to.
If no stratification variable is defined this will default to 1 for all subjects
(i.e. same group).
This field is only used as part of the <code>self$sample_ids()</code> function to enable
stratified bootstrap
sampling</p></dd>


<dt><code>ice_visit_index</code></dt>
<dd><p>A list indexed by subject storing the index number of the first visit
affected by the ICE. If there is no ICE then it is set equal to the number of visits plus 1.</p></dd>


<dt><code>values</code></dt>
<dd><p>A list indexed by subject storing a numeric vector of the
original (unimputed) outcome values</p></dd>


<dt><code>group</code></dt>
<dd><p>A list indexed by subject storing a single character
indicating which imputation group the subject belongs to as defined
by <code>self$data[id, self$ivars$group]</code>
It is used
to determine what reference group should be used when imputing the subjects data.</p></dd>


<dt><code>is_mar</code></dt>
<dd><p>A list indexed by subject storing logical values indicating
if the subjects outcome values are MAR or not.
This list is defaulted to TRUE for all subjects &amp; outcomes and is then
modified by calls to <code>self$set_strategies()</code>.
Note that this does not indicate which values are missing, this variable
is True for outcome values that either occurred before the ICE visit
or are post the ICE visit and have an imputation strategy of MAR</p></dd>


<dt><code>strategies</code></dt>
<dd><p>A list indexed by subject storing a single character
value indicating the imputation
strategy assigned to that subject. This list is defaulted to "MAR"
for all subjects and is then
modified by calls to either <code>self$set_strategies()</code> or <code>self$update_strategies()</code></p></dd>


<dt><code>strategy_lock</code></dt>
<dd><p>A list indexed by subject storing a single
logical value indicating whether a
patients imputation strategy is locked or not. If a strategy is
locked it means that it can't change
from MAR to non-MAR. Strategies can be changed from non-MAR to MAR though
this will trigger a warning.
Strategies are locked if the patient is assigned a MAR strategy and
has non-missing after their ICE date. This list is populated by a call to
<code>self$set_strategies()</code>.</p></dd>


<dt><code>indexes</code></dt>
<dd>
<p>A list indexed by subject storing a numeric vector of
indexes which specify which rows in the
original dataset belong to this subject i.e. to recover the full data
for subject "pt3" you can use
<code>self$data[self$indexes[["pt3"]],]</code>. This may seem redundant over filtering
the data directly
however it enables efficient bootstrap sampling of the data i.e.</p>
<p></p>
<div class="sourceCode">
<pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>indexes <span class="ot">&lt;-</span> <span class="fu">unlist</span>(self<span class="sc">$</span>indexes[<span class="fu">c</span>(<span class="st">"pt3"</span>, <span class="st">"pt3"</span>)])</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>self<span class="sc">$</span>data[indexes,]</span></code></pre>
<p></p>
</div>
<p>This list is populated during the object initialisation.</p>
</dd>


<dt><code>is_missing</code></dt>
<dd><p>A list indexed by subject storing a logical vector
indicating whether the corresponding
outcome of a subject is missing. This list is populated during the
object initialisation.</p></dd>


<dt><code>is_post_ice</code></dt>
<dd><p>A list indexed by subject storing a logical vector
indicating whether the corresponding
outcome of a subject is post the date of their ICE. If no ICE data has
been provided this defaults to False
for all observations. This list is populated by a call to <code>self$set_strategies()</code>.</p></dd>


</dl>
<p></p>
</div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a>
</h3>

<ul>
<li><p><a href="#method-longdata-get_data"><code>longDataConstructor$get_data()</code></a></p></li>
<li><p><a href="#method-longdata-add_subject"><code>longDataConstructor$add_subject()</code></a></p></li>
<li><p><a href="#method-longdata-validate_ids"><code>longDataConstructor$validate_ids()</code></a></p></li>
<li><p><a href="#method-longdata-sample_ids"><code>longDataConstructor$sample_ids()</code></a></p></li>
<li><p><a href="#method-longdata-extract_by_id"><code>longDataConstructor$extract_by_id()</code></a></p></li>
<li><p><a href="#method-longdata-update_strategies"><code>longDataConstructor$update_strategies()</code></a></p></li>
<li><p><a href="#method-longdata-set_strategies"><code>longDataConstructor$set_strategies()</code></a></p></li>
<li><p><a href="#method-longdata-check_has_data_at_each_visit"><code>longDataConstructor$check_has_data_at_each_visit()</code></a></p></li>
<li><p><a href="#method-longdata-set_strata"><code>longDataConstructor$set_strata()</code></a></p></li>
<li><p><a href="#method-longdata-new"><code>longDataConstructor$new()</code></a></p></li>
<li><p><a href="#method-longdata-clone"><code>longDataConstructor$clone()</code></a></p></li>
</ul>
</div>
<p></p>
<hr>
<a id="method-longdata-get_data"></a><div class="section">
<h3 id="method-get-data-">Method <code>get_data()</code><a class="anchor" aria-label="anchor" href="#method-get-data-"></a>
</h3>
<p>Returns a <code>data.frame</code> based upon required subject IDs. Replaces missing
values with new ones if provided.</p>
<div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h4>
<p></p>
<div class="r">
<div class="sourceCode"><pre><code><span><span class="va">longDataConstructor</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span></span>
<span>  obj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nmar.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  idmap <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a>
</h4>
<p></p>
<div class="arguments">
<dl>
<dt><code>obj</code></dt>
<dd><p>Either <code>NULL</code>, a character vector of subjects IDs or a
imputation list object. See details.</p></dd>


<dt><code>nmar.rm</code></dt>
<dd><p>Logical value. If <code>TRUE</code> will remove observations that are
not regarded as MAR (as determined from <code>self$is_mar</code>).</p></dd>


<dt><code>na.rm</code></dt>
<dd><p>Logical value. If <code>TRUE</code> will remove outcome values that are
missing (as determined from <code>self$is_missing</code>).</p></dd>


<dt><code>idmap</code></dt>
<dd><p>Logical value. If <code>TRUE</code> will add an attribute <code>idmap</code> which
contains a mapping from the new subject ids to the old subject ids. See details.</p></dd>


</dl>
<p></p>
</div>
</div>
<div class="section">
<h4 id="details-1">Details<a class="anchor" aria-label="anchor" href="#details-1"></a>
</h4>
<p>If <code>obj</code> is <code>NULL</code> then the full original dataset is returned.</p>
<p>If <code>obj</code> is a character vector then a new dataset consisting of just those subjects is
returned; if the character vector contains duplicate entries then that subject will be
returned multiple times.</p>
<p>If <code>obj</code> is an <code>imputation_df</code> object (as created by <code><a href="imputation_df.html">imputation_df()</a></code>) then the
subject ids specified in the object will be returned and missing values will be filled
in by those specified in the imputation list object.  i.e.</p>
<p></p>
<div class="sourceCode">
<pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="fu">imputation_df</span>(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="fu">imputation_single</span>( <span class="at">id =</span> <span class="st">"pt1"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="fu">imputation_single</span>( <span class="at">id =</span> <span class="st">"pt1"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)),</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="fu">imputation_single</span>( <span class="at">id =</span> <span class="st">"pt3"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">8</span>))</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>longdata<span class="sc">$</span><span class="fu">get_data</span>(obj)</span></code></pre>
<p></p>
</div>
<p>Will return a <code>data.frame</code> consisting of all observations for <code>pt1</code> twice and all of the
observations for <code>pt3</code> once. The first set of observations for <code>pt1</code> will have missing
values filled in with <code>c(1,2,3)</code> and the second set will be filled in by <code>c(4,5,6)</code>. The
length of the values must be equal to <code>sum(self$is_missing[[id]])</code>.</p>
<p>If <code>obj</code> is not <code>NULL</code> then all subject IDs will be scrambled in order to ensure that they
are unique
i.e. If the <code>pt2</code> is requested twice then this process guarantees that each set of observations
be have a unique subject ID number. The <code>idmap</code> attribute (if requested) can be used
to map from the new ids back to the old ids.</p>
</div>

<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a>
</h4>
<p>A <code>data.frame</code>.</p>
</div>

</div>
<p></p>
<hr>
<a id="method-longdata-add_subject"></a><div class="section">
<h3 id="method-add-subject-">Method <code>add_subject()</code><a class="anchor" aria-label="anchor" href="#method-add-subject-"></a>
</h3>
<p>This function decomposes a patient data from <code>self$data</code> and populates
all the corresponding lists i.e. <code>self$is_missing</code>, <code>self$values</code>, <code>self$group</code>, etc.
This function is only called upon the objects initialization.</p>
<div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a>
</h4>
<p></p>
<div class="r">
<div class="sourceCode"><pre><code><span><span class="va">longDataConstructor</span><span class="op">$</span><span class="fu">add_subject</span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a>
</h4>
<p></p>
<div class="arguments">
<dl>
<dt><code>id</code></dt>
<dd><p>Character subject id that exists within <code>self$data</code>.</p></dd>


</dl>
<p></p>
</div>
</div>

</div>
<p></p>
<hr>
<a id="method-longdata-validate_ids"></a><div class="section">
<h3 id="method-validate-ids-">Method <code>validate_ids()</code><a class="anchor" aria-label="anchor" href="#method-validate-ids-"></a>
</h3>
<p>Throws an error if any element of <code>ids</code> is not within the source data <code>self$data</code>.</p>
<div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a>
</h4>
<p></p>
<div class="r">
<div class="sourceCode"><pre><code><span><span class="va">longDataConstructor</span><span class="op">$</span><span class="fu">validate_ids</span><span class="op">(</span><span class="va">ids</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a>
</h4>
<p></p>
<div class="arguments">
<dl>
<dt><code>ids</code></dt>
<dd><p>A character vector of ids.</p></dd>


</dl>
<p></p>
</div>
</div>
<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a>
</h4>
<p>TRUE</p>
</div>

</div>
<p></p>
<hr>
<a id="method-longdata-sample_ids"></a><div class="section">
<h3 id="method-sample-ids-">Method <code><a href="sample_ids.html">sample_ids()</a></code><a class="anchor" aria-label="anchor" href="#method-sample-ids-"></a>
</h3>
<p>Performs random stratified sampling of patient ids (with replacement)
Each patient has an equal weight of being picked within their strata (i.e is not dependent on
how many non-missing visits they had).</p>
<div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a>
</h4>
<p></p>
<div class="r">
<div class="sourceCode"><pre><code><span><span class="va">longDataConstructor</span><span class="op">$</span><span class="fu">sample_ids</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
</div>

<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a>
</h4>
<p>Character vector of ids.</p>
</div>

</div>
<p></p>
<hr>
<a id="method-longdata-extract_by_id"></a><div class="section">
<h3 id="method-extract-by-id-">Method <code>extract_by_id()</code><a class="anchor" aria-label="anchor" href="#method-extract-by-id-"></a>
</h3>
<p>Returns a list of key information for a given subject. Is a convenience wrapper
to save having to manually grab each element.</p>
<div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a>
</h4>
<p></p>
<div class="r">
<div class="sourceCode"><pre><code><span><span class="va">longDataConstructor</span><span class="op">$</span><span class="fu">extract_by_id</span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a>
</h4>
<p></p>
<div class="arguments">
<dl>
<dt><code>id</code></dt>
<dd><p>Character subject id that exists within <code>self$data</code>.</p></dd>


</dl>
<p></p>
</div>
</div>

</div>
<p></p>
<hr>
<a id="method-longdata-update_strategies"></a><div class="section">
<h3 id="method-update-strategies-">Method <code>update_strategies()</code><a class="anchor" aria-label="anchor" href="#method-update-strategies-"></a>
</h3>
<p>Convenience function to run self$set_strategies(dat_ice, update=TRUE)
kept for legacy reasons.</p>
<div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a>
</h4>
<p></p>
<div class="r">
<div class="sourceCode"><pre><code><span><span class="va">longDataConstructor</span><span class="op">$</span><span class="fu">update_strategies</span><span class="op">(</span><span class="va">dat_ice</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a>
</h4>
<p></p>
<div class="arguments">
<dl>
<dt><code>dat_ice</code></dt>
<dd><p>A <code>data.frame</code> containing ICE information see <code><a href="impute.html">impute()</a></code> for the format of this dataframe.</p></dd>


</dl>
<p></p>
</div>
</div>

</div>
<p></p>
<hr>
<a id="method-longdata-set_strategies"></a><div class="section">
<h3 id="method-set-strategies-">Method <code>set_strategies()</code><a class="anchor" aria-label="anchor" href="#method-set-strategies-"></a>
</h3>
<p>Updates the <code>self$strategies</code>, <code>self$is_mar</code>, <code>self$is_post_ice</code> variables based upon the provided ICE
information.</p>
<div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a>
</h4>
<p></p>
<div class="r">
<div class="sourceCode"><pre><code><span><span class="va">longDataConstructor</span><span class="op">$</span><span class="fu">set_strategies</span><span class="op">(</span>dat_ice <span class="op">=</span> <span class="cn">NULL</span>, update <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a>
</h4>
<p></p>
<div class="arguments">
<dl>
<dt><code>dat_ice</code></dt>
<dd><p>a <code>data.frame</code> containing ICE information. See details.</p></dd>


<dt><code>update</code></dt>
<dd><p>Logical, indicates that the ICE data should be used as an update. See details.</p></dd>


</dl>
<p></p>
</div>
</div>
<div class="section">
<h4 id="details-2">Details<a class="anchor" aria-label="anchor" href="#details-2"></a>
</h4>
<p>See <code><a href="draws.html">draws()</a></code> for the specification of <code>dat_ice</code> if <code>update=FALSE</code>.
See <code><a href="impute.html">impute()</a></code> for the format of <code>dat_ice</code> if <code>update=TRUE</code>.
If <code>update=TRUE</code> this function ensures that MAR strategies cannot be changed to non-MAR in the presence
of post-ICE observations.</p>
</div>


</div>
<p></p>
<hr>
<a id="method-longdata-check_has_data_at_each_visit"></a><div class="section">
<h3 id="method-check-has-data-at-each-visit-">Method <code>check_has_data_at_each_visit()</code><a class="anchor" aria-label="anchor" href="#method-check-has-data-at-each-visit-"></a>
</h3>
<p>Ensures that all visits have at least 1 observed "MAR" observation. Throws
an error if this criteria is not met. This is to ensure that the initial
MMRM can be resolved.</p>
<div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a>
</h4>
<p></p>
<div class="r">
<div class="sourceCode"><pre><code><span><span class="va">longDataConstructor</span><span class="op">$</span><span class="fu">check_has_data_at_each_visit</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
</div>


</div>
<p></p>
<hr>
<a id="method-longdata-set_strata"></a><div class="section">
<h3 id="method-set-strata-">Method <code>set_strata()</code><a class="anchor" aria-label="anchor" href="#method-set-strata-"></a>
</h3>
<p>Populates the <code>self$strata</code> variable. If the user has specified stratification variables
The first visit is used to determine the value of those variables. If no stratification variables
have been specified then everyone is defined as being in strata 1.</p>
<div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a>
</h4>
<p></p>
<div class="r">
<div class="sourceCode"><pre><code><span><span class="va">longDataConstructor</span><span class="op">$</span><span class="fu">set_strata</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
</div>


</div>
<p></p>
<hr>
<a id="method-longdata-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a>
</h3>
<p>Constructor function.</p>
<div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a>
</h4>
<p></p>
<div class="r">
<div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/longDataConstructor.html">longDataConstructor</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">data</span>, <span class="va">vars</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a>
</h4>
<p></p>
<div class="arguments">
<dl>
<dt><code>data</code></dt>
<dd><p>longitudinal dataset.</p></dd>


<dt><code>vars</code></dt>
<dd><p>an <code>ivars</code> object created by <code><a href="set_vars.html">set_vars()</a></code>.</p></dd>


</dl>
<p></p>
</div>
</div>

</div>
<p></p>
<hr>
<a id="method-longdata-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a>
</h3>
<p>The objects of this class are cloneable with this method.</p>
<div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a>
</h4>
<p></p>
<div class="r">
<div class="sourceCode"><pre><code><span><span class="va">longDataConstructor</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a>
</h4>
<p></p>
<div class="arguments">
<dl>
<dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl>
<p></p>
</div>
</div>

</div>

    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Craig Gower-Page, Alessandro Noci, Isaac Gravestock, Daniel Sabanes Bove, F. Hoffmann-La Roche AG.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>

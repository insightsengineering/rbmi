<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Set the multiple imputation methodology — method • rbmi</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Set the multiple imputation methodology — method"><meta name="description" content="These functions determine what methods rbmi should use when creating
the imputation models, generating imputed values and pooling the results."><meta property="og:description" content="These functions determine what methods rbmi should use when creating
the imputation models, generating imputed values and pooling the results."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rbmi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/advanced.html">rbmi: Advanced Functionality</a></li>
    <li><a class="dropdown-item" href="../articles/CondMean_Inference.html">rbmi: Inference with Conditional Mean Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/FAQ.html">rbmi: Frequently Asked Questions</a></li>
    <li><a class="dropdown-item" href="../articles/quickstart.html">rbmi: Quickstart</a></li>
    <li><a class="dropdown-item" href="../articles/retrieved_dropout.html">rbmi: Implementation of retrieved-dropout models using rbmi</a></li>
    <li><a class="dropdown-item" href="../articles/stat_specs.html">rbmi: Statistical Specifications</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/insightsengineering/rbmi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Set the multiple imputation methodology</h1>
      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/rbmi/blob/v1.4.0/R/methods.R" class="external-link"><code>R/methods.R</code></a></small>
      <div class="d-none name"><code>method.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions determine what methods <code>rbmi</code> should use when creating
the imputation models, generating imputed values and pooling the results.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">method_bayes</span><span class="op">(</span></span>
<span>  same_cov <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_samples <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="control.html">control_bayes</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  burn_in <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  burn_between <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">method_approxbayes</span><span class="op">(</span></span>
<span>  covariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"us"</span>, <span class="st">"ad"</span>, <span class="st">"adh"</span>, <span class="st">"ar1"</span>, <span class="st">"ar1h"</span>, <span class="st">"cs"</span>, <span class="st">"csh"</span>, <span class="st">"toep"</span>, <span class="st">"toeph"</span><span class="op">)</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  same_cov <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_samples <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">method_condmean</span><span class="op">(</span></span>
<span>  covariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"us"</span>, <span class="st">"ad"</span>, <span class="st">"adh"</span>, <span class="st">"ar1"</span>, <span class="st">"ar1h"</span>, <span class="st">"cs"</span>, <span class="st">"csh"</span>, <span class="st">"toep"</span>, <span class="st">"toeph"</span><span class="op">)</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  same_cov <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_samples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bootstrap"</span>, <span class="st">"jackknife"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">method_bmlmi</span><span class="op">(</span></span>
<span>  covariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"us"</span>, <span class="st">"ad"</span>, <span class="st">"adh"</span>, <span class="st">"ar1"</span>, <span class="st">"ar1h"</span>, <span class="st">"cs"</span>, <span class="st">"csh"</span>, <span class="st">"toep"</span>, <span class="st">"toeph"</span><span class="op">)</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  same_cov <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  D <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-same-cov">same_cov<a class="anchor" aria-label="anchor" href="#arg-same-cov"></a></dt>
<dd><p>a logical, if <code>TRUE</code> the imputation model will be fitted using a single
shared covariance matrix for all observations. If <code>FALSE</code> a separate covariance
matrix will be fit for each group as determined by the <code>group</code> argument of
<code><a href="set_vars.html">set_vars()</a></code>.</p></dd>


<dt id="arg-n-samples">n_samples<a class="anchor" aria-label="anchor" href="#arg-n-samples"></a></dt>
<dd><p>a numeric that determines how many imputed datasets are generated.
In the case of <code>method_condmean(type = "jackknife")</code> this argument
must be set to <code>NULL</code>. See details.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>a list which specifies further lower level details of the computations.
Currently only used by <code>method_bayes()</code>, please see <code><a href="control.html">control_bayes()</a></code> for details and
default settings.</p></dd>


<dt id="arg-burn-in">burn_in<a class="anchor" aria-label="anchor" href="#arg-burn-in"></a></dt>
<dd><p>deprecated. Please use the <code>warmup</code> argument in <code><a href="control.html">control_bayes()</a></code> instead.</p></dd>


<dt id="arg-burn-between">burn_between<a class="anchor" aria-label="anchor" href="#arg-burn-between"></a></dt>
<dd><p>deprecated. Please use the <code>thin</code> argument in <code><a href="control.html">control_bayes()</a></code> instead.</p></dd>


<dt id="arg-covariance">covariance<a class="anchor" aria-label="anchor" href="#arg-covariance"></a></dt>
<dd><p>a character string that specifies the structure of the covariance
matrix to be used in the imputation model. Must be one of <code>"us"</code> (default), <code>"ad"</code>,
<code>"adh"</code>, <code>"ar1"</code>, <code>"ar1h"</code>, <code>"cs"</code>, <code>"csh"</code>, <code>"toep"</code>, or <code>"toeph"</code>). See details.</p></dd>


<dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>a numeric between 0 and 1, specifies the proportion of bootstrap
datasets that can fail to produce valid samples before an error is thrown.
See details.</p></dd>


<dt id="arg-reml">REML<a class="anchor" aria-label="anchor" href="#arg-reml"></a></dt>
<dd><p>a logical indicating whether to use REML estimation rather than maximum
likelihood.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>a character string that specifies the resampling method used to perform inference
when a conditional mean imputation approach (set via <code>method_condmean()</code>) is used.
Must be one of <code>"bootstrap"</code> or <code>"jackknife"</code>.</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>a numeric that determines the number of bootstrap samples for <code>method_bmlmi</code>.</p></dd>


<dt id="arg-d">D<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>a numeric that determines the number of random imputations for each bootstrap sample.
Needed for <code>method_bmlmi()</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In the case of <code>method_condmean(type = "bootstrap")</code> there will be <code>n_samples + 1</code>
imputation models and datasets generated as the first sample will be based on
the original dataset whilst the other <code>n_samples</code> samples will be
bootstrapped datasets. Likewise, for <code>method_condmean(type = "jackknife")</code> there will
be <code>length(unique(data$subjid)) + 1</code> imputation models and datasets generated. In both cases this is
represented by <code>n + 1</code> being displayed in the print message.
In the case that <code>method_bayes()</code> is used, and with the <code>control</code> argument the number of chains
is set to more than 1, then the <code>n_samples</code> samples will be distributed across the chains.
The total number of returned samples will still be <code>n_samples</code>.</p>
<p>The user is able to specify different covariance structures using the the <code>covariance</code>
argument. Currently supported structures include:</p><ul><li><p>Unstructured (<code>"us"</code>) (default)</p></li>
<li><p>Ante-dependence (<code>"ad"</code>)</p></li>
<li><p>Heterogeneous ante-dependence (<code>"adh"</code>)</p></li>
<li><p>First-order auto-regressive (<code>"ar1"</code>)</p></li>
<li><p>Heterogeneous first-order auto-regressive (<code>"ar1h"</code>)</p></li>
<li><p>Compound symmetry (<code>"cs"</code>)</p></li>
<li><p>Heterogeneous compound symmetry (<code>"csh"</code>)</p></li>
<li><p>Toeplitz (<code>"toep"</code>)</p></li>
<li><p>Heterogeneous Toeplitz (<code>"toeph"</code>)</p></li>
</ul><p>For full details please see <code><a href="https://openpharma.github.io/mmrm/latest-tag/reference/covariance_types.html" class="external-link">mmrm::cov_types()</a></code>.</p>
<p>Note that at present Bayesian methods only support unstructured.</p>
<p>In the case of <code>method_condmean(type = "bootstrap")</code>, <code>method_approxbayes()</code> and <code>method_bmlmi()</code> repeated
bootstrap samples of the original dataset are taken with an MMRM fitted to each sample.
Due to the randomness of these sampled datasets, as well as limitations in the optimisers
used to fit the models, it is not uncommon that estimates for a particular dataset can't
be generated. In these instances <code>rbmi</code> is designed to throw out that bootstrapped dataset
and try again with another. However to ensure that these errors are due to chance and
not due to some underlying misspecification in the data and/or model a tolerance limit
is set on how many samples can be discarded. Once the tolerance limit has been reached
an error will be thrown and the process aborted. The tolerance limit is defined as
<code>ceiling(threshold * n_samples)</code>. Note that for the jackknife method estimates need to be
generated for all leave-one-out datasets and as such an error will be thrown if
any of them fail to fit.</p>
<p>Please note that at the time of writing (September 2021) Stan is unable to produce
reproducible samples across different operating systems even when the same seed is used.
As such care must be taken when using Stan across different machines. For more information
on this limitation please consult the Stan documentation
<a href="https://mc-stan.org/docs/2_27/reference-manual/reproducibility-chapter.html" class="external-link">https://mc-stan.org/docs/2_27/reference-manual/reproducibility-chapter.html</a></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Craig Gower-Page, Alessandro Noci, Isaac Gravestock, Daniel Sabanes Bove, F. Hoffmann-La Roche AG.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

